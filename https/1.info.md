#网络服务和安全
为了在网络中传输数据，需要加密，但应用层需要透明处理

#SSL、TSL、HTTPS
SSL (secure sockets layer) 安全套接层
TLS (Transport Layer Security) 安全传输协议 ， 对应TCP 。
SSL 是TLS的前身，现在已不再更新。
HTTPS 是在基于TLS/SSL的安全套接字上的的应用层协议，除了传输层进行了加密外，其它与常规HTTP协议基本保持一致

#加密
##对称加密
双方都持有相同的密钥，这样就暴露了密钥

##非对称加密
（发起请求的视为client， 接收请求的视为server， 这是相对的。）
密钥分为两部分，私钥 和 公钥。私钥就像是一把钥匙；公钥就像是很多把一样的锁。

公钥加密，私钥解密：server把公钥分发给多个client，用于加密数据；server自己保存私钥，用于解密数据。
底层用了openssl

#安全隐患
中间人攻击，这个隐患出现在交换公钥的时候
client在与server建立安全连接前，被中间人冒充server，中间人就持有了client的公钥，并冒充server把自己的公钥给client。
server端遭受与client一样的遭遇。
这样，server和client通信加密数据都是用中间人的公钥加密，中间人当然可以解密，再用双方的证书加密，发给双方。

##证书
证书是TLS协议中用来对身份进行验证的机制，是一种数字签名形式的文件，包含证书拥有者的公钥及第三方的证书信息。

证书分为2类：自签名证书和CA证书。一般自签名证书不能用来进行身份认证，如果一个server端使用自签名证书，client端要么被设置为无条件信任任何证书，要么需要将自签名证书的公钥和私钥加入受信任列表。但这样一来就增加了server的私钥泄露风险。

##ca证书
每个服务器可以向CA认证机构申请一个证书，
包括主机名，IP，颁发的机构，还有机构的公钥
在连接之前，需要确认证书中的签名来自目标服务器，从而信任。

##握手流程

HTTPS链接的建立过程中涉及到服务器端证书、客户端证书（可选）、服务器端的非对称秘钥以及后续通信过程中使用的对称秘钥几个内容。

1.客户端对HTTPS的地址发出请求，并且将自己的SSL版本号等信息发送给服务器
2.服务器接收到请求，将服务器证书和公钥等信息返回给客户端
3.客户端接收到证书后向证书颁发机构验证证书的合法性。如果证书不合法（比如自行签发的证书），则向用户发出警告并确认是否继续，用户可以选择在此时离开终止HTTPS的链接。
4.证书合法或客户端确认在不安全的情况下继续，客户端生成pre-master secret并且使用2中收到的服务器公钥加密后发送给服务器。如果是使用交互策略的TLS，则同时需要将客户端的证书发送给服务器。服务器检查客户端的证书颁发机构是否在信任列表中，以及证书内容是否合法。若不合法，结束本次会话。
5.服务器使用私钥解密pre-master secret，然后双方通过一种实现商定好的加密算法生成本次通讯使用的master secret。
6.双方互相通知对方本次SSL握手成功，其后均使用master secret对传输内容进行加密。